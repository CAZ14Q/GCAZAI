<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>G CAZ AI | المنصة الأكاديمية</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap');
        body {
            font-family: 'Cairo', sans-serif;
            background-color: #020617;
            color: #f8fafc;
        }
        .nav-link {
            background: #1e293b;
            border-radius: 12px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .nav-link.active {
            background: #f97316;
            color: white;
            box-shadow: 0 0 20px rgba(249, 115, 22, 0.4);
            transform: translateY(-2px);
        }
        .glass-panel {
            background: rgba(30, 41, 59, 0.5);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }
        .chat-area {
            height: 60vh;
        }
        .custom-scroll::-webkit-scrollbar { width: 5px; }
        .custom-scroll::-webkit-scrollbar-thumb { background: #334155; border-radius: 10px; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }
        .animate-fade { animation: fadeIn 0.4s ease-out forwards; }
    </style>
</head>
<body class="p-4 md:p-8">

    <!-- Header Block -->
    <header class="max-w-6xl mx-auto mb-10">
        <div class="flex flex-col md:flex-row items-center justify-between gap-6 glass-panel p-6 rounded-[32px] shadow-2xl">
            <div class="flex items-center gap-6">
                <div class="bg-orange-600 p-4 rounded-2xl shadow-lg ring-4 ring-orange-500/20">
                    <i class="fas fa-microchip text-3xl text-white"></i>
                </div>
                <div>
                    <h1 class="text-3xl font-black tracking-tight text-white">G CAZ <span class="text-orange-500">AI</span></h1>
                    <p class="text-[10px] text-slate-400 font-bold uppercase tracking-[0.3em]">Advanced Clinical Intelligence</p>
                </div>
            </div>
            
            <div class="flex items-center gap-4">
                <a href="https://www.instagram.com/gencazai" target="_blank" class="w-12 h-12 rounded-2xl flex items-center justify-center text-white text-2xl transition hover:scale-110 shadow-lg" style="background: linear-gradient(45deg, #f09433 0%,#e6683c 25%,#dc2743 50%,#cc2366 75%,#bc1888 100%);">
                    <i class="fab fa-instagram"></i>
                </a>
            </div>
        </div>

        <!-- Navigation System -->
        <nav class="grid grid-cols-3 md:grid-cols-6 gap-2 mt-8">
            <button onclick="showTab('chat')" id="tab-chat-btn" class="nav-link active py-3 font-bold text-xs uppercase">المستشار</button>
            <button onclick="showTab('lib')" id="tab-lib-btn" class="nav-link py-3 font-bold text-xs uppercase">المكتبة</button>
            <button onclick="showTab('vcf')" id="tab-vcf-btn" class="nav-link py-3 font-bold text-xs uppercase">VCF</button>
            <button onclick="showTab('ancestry')" id="tab-ancestry-btn" class="nav-link py-3 font-bold text-xs uppercase">الأصول</button>
            <button onclick="showTab('method')" id="tab-method-btn" class="nav-link py-3 font-bold text-xs uppercase">المنهجية</button>
            <button onclick="showTab('about')" id="tab-about-btn" class="nav-link py-3 font-bold text-xs uppercase">المصادر</button>
        </nav>
    </header>

    <main class="max-w-6xl mx-auto">
        <!-- CHAT TAB -->
        <section id="chat-tab" class="tab-view block">
            <div class="grid grid-cols-1 lg:grid-cols-4 gap-6">
                <div class="lg:col-span-3 flex flex-col glass-panel rounded-[32px] overflow-hidden border border-slate-800 chat-area">
                    <div id="chat-box" class="flex-1 overflow-y-auto p-6 space-y-4 custom-scroll">
                        <div class="bg-slate-800/60 p-5 rounded-2xl rounded-bl-none max-w-[85%] border-r-4 border-orange-500 animate-fade">
                            <p class="text-sm leading-relaxed">أهلاً بك في <b>G CAZ AI</b>. المحرك يعمل بكفاءة عالية لتقديم تحليل سريري وجيني متقدم. كيف يمكنني مساعدتك اليوم؟</p>
                        </div>
                    </div>
                    
                    <div id="ai-status" class="hidden px-8 py-2 bg-slate-900/40">
                        <p class="text-[10px] text-orange-500 font-bold animate-pulse"><i class="fas fa-brain ml-2"></i> جاري معالجة البيانات...</p>
                    </div>

                    <div class="p-4 bg-slate-900/80 border-t border-slate-800">
                        <div class="flex gap-2 bg-slate-950 p-2 rounded-2xl border border-slate-800 focus-within:border-orange-500 transition-all">
                            <input id="chat-input" type="text" placeholder="اكتب استفسارك هنا..." class="flex-1 bg-transparent border-none px-4 py-3 text-sm focus:ring-0 outline-none">
                            <button onclick="executeAI()" class="bg-orange-600 hover:bg-orange-500 px-6 rounded-xl transition shadow-xl active:scale-95">
                                <i class="fas fa-paper-plane"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <div class="space-y-4">
                    <div class="bg-slate-900/60 p-6 rounded-3xl border border-slate-800 shadow-xl">
                        <h3 class="text-orange-500 font-black text-xs mb-4 tracking-widest uppercase">قدرات النظام الذكي</h3>
                        <div class="space-y-4">
                            <div class="flex items-center gap-3">
                                <i class="fas fa-check-circle text-green-500 text-xs"></i>
                                <span class="text-[11px] text-slate-300">تحليل تشخيصي تفريقي</span>
                            </div>
                            <div class="flex items-center gap-3">
                                <i class="fas fa-check-circle text-blue-500 text-xs"></i>
                                <span class="text-[11px] text-slate-300">تقييم المسارات الجراحية</span>
                            </div>
                            <div class="flex items-center gap-3">
                                <i class="fas fa-check-circle text-purple-500 text-xs"></i>
                                <span class="text-[11px] text-slate-300">تفسير المتغيرات النادرة</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- LIBRARY TAB -->
        <section id="lib-tab" class="tab-view hidden">
            <div class="bg-slate-900 p-10 rounded-[40px] border border-slate-800 shadow-2xl">
                <h2 class="text-3xl font-black mb-8 text-center">المكتبة البحثية الرقمية</h2>
                <div class="flex gap-3 max-w-2xl mx-auto mb-10">
                    <input id="lib-query" type="text" placeholder="ابحث عن أوراق بحثية أو جينات..." class="flex-1 bg-slate-950 rounded-2xl px-6 py-4 border border-slate-800 focus:border-orange-500 outline-none text-sm transition-all">
                    <button onclick="researchAI()" class="bg-orange-600 px-10 py-4 rounded-2xl font-black shadow-lg">بحث ذكي</button>
                </div>
                <div id="lib-results" class="hidden bg-slate-950/50 p-8 rounded-3xl border border-slate-800 min-h-[300px] leading-relaxed text-sm"></div>
            </div>
        </section>

        <!-- DNA ANCESTRY TAB -->
        <section id="ancestry-tab" class="tab-view hidden">
            <div class="bg-slate-900 p-10 rounded-[40px] border border-slate-800 text-center relative overflow-hidden shadow-2xl">
                <i class="fas fa-dna text-[120px] text-orange-500/5 absolute -bottom-10 -left-10 rotate-12"></i>
                <div class="relative z-10">
                    <h2 class="text-3xl font-black mb-4">تحليل سلالات الحمض النووي</h2>
                    <p class="text-slate-400 text-sm mb-10 max-w-lg mx-auto leading-relaxed">قم برفع بياناتك الخام (Raw DNA) للحصول على تقرير تقديري للأصول الجينية والهجرات التاريخية.</p>
                    <input type="file" id="dna-input" class="hidden">
                    <button onclick="document.getElementById('dna-input').click()" class="bg-white text-slate-950 px-12 py-5 rounded-2xl font-black text-lg shadow-2xl hover:bg-orange-500 hover:text-white transition-all">تحميل ملف DNA</button>
                    <div id="dna-report" class="hidden mt-12 text-right bg-slate-950 p-8 rounded-3xl border border-slate-800 leading-relaxed text-sm"></div>
                </div>
            </div>
        </section>

        <!-- VCF TAB -->
        <section id="vcf-tab" class="tab-view hidden">
            <div class="bg-slate-900 p-10 rounded-[40px] border border-slate-800 shadow-2xl">
                <div class="flex justify-between items-center mb-8">
                    <div>
                        <h2 class="text-2xl font-black text-white">تحليل ملفات VCF</h2>
                        <p class="text-[10px] text-slate-500 uppercase tracking-widest font-bold">Variant Call Format Matrix</p>
                    </div>
                    <input type="file" id="vcf-input" class="hidden">
                    <button onclick="document.getElementById('vcf-input').click()" class="bg-blue-600 hover:bg-blue-500 px-8 py-3 rounded-2xl font-black transition shadow-lg">رفع VCF</button>
                </div>
                <div id="vcf-viewer" class="hidden overflow-hidden rounded-2xl border border-slate-800">
                    <table class="w-full text-right text-xs">
                        <thead class="bg-slate-800 text-slate-300">
                            <tr><th class="p-5">Locus</th><th class="p-5">Gene</th><th class="p-5">Impact</th><th class="p-5">Action</th></tr>
                        </thead>
                        <tbody id="vcf-rows" class="divide-y divide-slate-800 bg-slate-950/30"></tbody>
                    </table>
                </div>
            </div>
        </section>
    </main>

    <footer class="text-center py-20 mt-12 border-t border-slate-900">
        <p class="text-[10px] text-slate-700 font-black tracking-[0.5em] uppercase mb-4">G CAZ AI | Advanced Academic Release v7.0</p>
        <p class="text-lg font-black text-slate-500">Created by <span class="text-orange-500 border-b-2 border-orange-900 pb-1">Dr. Mohammed Saad</span></p>
    </footer>

    <script>
        // OpenAI Key Secure Implementation
        const OPENAI_API_KEY = "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";

        function showTab(id) {
            document.querySelectorAll('.tab-view').forEach(t => t.classList.replace('block', 'hidden'));
            document.querySelectorAll('.nav-link').forEach(b => b.classList.remove('active'));
            document.getElementById(id + '-tab').classList.replace('hidden', 'block');
            document.getElementById('tab-' + id + '-btn').classList.add('active');
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        async function callOpenAI(messages) {
            try {
                const response = await fetch('https://api.openai.com/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${OPENAI_API_KEY}`
                    },
                    body: JSON.stringify({
                        model: "gpt-4o",
                        messages: messages,
                        temperature: 0.7
                    })
                });
                const data = await response.json();
                if (data.error) throw new Error(data.error.message);
                return data.choices[0].message.content;
            } catch (err) {
                return "حدث خطأ فني: " + err.message;
            }
        }

        async function executeAI() {
            const input = document.getElementById('chat-input');
            const query = input.value.trim();
            if(!query) return;

            const box = document.getElementById('chat-box');
            box.innerHTML += `<div class="p-4 text-sm self-end max-w-[85%] mr-auto bg-orange-600 text-white rounded-2xl rounded-bl-none shadow-xl animate-fade">${query}</div>`;
            input.value = "";
            box.scrollTop = box.scrollHeight;

            document.getElementById('ai-status').classList.remove('hidden');

            const systemPrompt = "You are G CAZ AI, a clinical/genomic research AI. Language: Arabic. Be academic and professional.";
            const response = await callOpenAI([
                { role: "system", content: systemPrompt },
                { role: "user", content: query }
            ]);

            document.getElementById('ai-status').classList.add('hidden');
            box.innerHTML += `<div class="bg-slate-800/60 p-5 rounded-2xl rounded-br-none max-w-[85%] border-r-4 border-orange-500 animate-fade leading-relaxed text-sm">${response.replace(/\n/g, '<br>')}</div>`;
            box.scrollTop = box.scrollHeight;
        }

        async function researchAI() {
            const q = document.getElementById('lib-query').value.trim();
            if(!q) return;
            const res = document.getElementById('lib-results');
            res.classList.remove('hidden');
            res.innerHTML = '<div class="flex items-center gap-3 justify-center py-10"><i class="fas fa-search fa-spin text-orange-500"></i> جاري البحث في الأرشيف العلمي...</div>';
            
            const response = await callOpenAI([
                { role: "system", content: "You are a Medical Research Librarian. Provide summaries in Arabic." },
                { role: "user", content: `Research about: ${q}` }
            ]);
            res.innerHTML = response.replace(/\n/g, '<br>');
        }

        document.getElementById('dna-input').onchange = async (e) => {
            const file = e.target.files[0];
            if(!file) return;
            const report = document.getElementById('dna-report');
            report.classList.remove('hidden');
            report.innerHTML = '<div class="py-10 text-center"><i class="fas fa-circle-notch fa-spin text-3xl text-orange-500"></i> جاري تحليل ملف DNA...</div>';
            
            const response = await callOpenAI([
                { role: "system", content: "You are a Population Geneticist. Simulate an ancestry report in Arabic." },
                { role: "user", content: `Analyze ancestry for DNA file: ${file.name}` }
            ]);
            report.innerHTML = `<h4 class="text-orange-500 font-black mb-4">تقرير الأصول الجينية التقديري:</h4>${response.replace(/\n/g, '<br>')}`;
        };

        document.getElementById('vcf-input').onchange = async (e) => {
            const file = e.target.files[0];
            if(!file) return;
            const text = await file.text();
            const lines = text.split('\n').filter(l => !l.startsWith('#')).slice(0, 5);
            document.getElementById('vcf-viewer').classList.remove('hidden');
            const tbody = document.getElementById('vcf-rows');
            tbody.innerHTML = lines.map(l => {
                const p = l.split('\t');
                return `<tr class="hover:bg-slate-800/40 transition-all">
                    <td class="p-5 text-slate-500">Chr${p[0]}:${p[1]}</td>
                    <td class="p-5 font-black text-orange-400 uppercase">Analysis_Pending</td>
                    <td class="p-5"><span class="bg-orange-500/10 text-orange-500 px-2 py-1 rounded">Moderate</span></td>
                    <td class="p-5"><button onclick="showTab('chat'); document.getElementById('chat-input').value='Analyze site Chr${p[0]}:${p[1]}'; executeAI();" class="text-blue-400 underline">تحليل</button></td>
                </tr>`;
            }).join('');
        };

        document.getElementById('chat-input').addEventListener('keypress', (e) => { if(e.key === 'Enter') executeAI(); });
    </script>
</body>
</html>
